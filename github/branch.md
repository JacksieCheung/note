## git 使用中的一些技巧

说到 git 这个名词，我们可能会把它称为代码托管仓库、码云等。其实它有一个更正式的名字，叫做“版本管理系统”。

所谓版本，指的是一个项目、一个代码的版本。版本这个概念应该很好理解，很多产品都有版本。比如go语言有1.14、1.15等版本，ubuntu也有18和20版本。

git 在我们多人开发项目中起到了很大的作用。本文将会介绍一些 git 有关的概念和一些技巧，帮助读者更好地使用和理解 git。

### 1. git 中分支的概念

git 中拉分支这个动作，实际上是从远程仓库中的某个版本拉出一个镜像到本地。

如图， `test_dev` 这个分支从版本3 中拉了一个分支，经过修改，分别提交了版本 4、5、6。

这么做的目的是让项目在多人开发时，不会互相影响和频繁地改动 master 分支。每个人只需要拉一个分支到本地操作，只修改自己那部分的代码。当我们写完时，就可以进行代码的合并。也就是图中`6--7`的过程。

上述过程就提及了 git 分支的工作流： 拉分支--本地开发--推分支--合并分支

其中推分支，意思就是我们每次 `git push` 时，不再用 `git push origin master` 而改为 `git push origin test_dev`。我们不再推主分支，而是推到自己的分支上。当我们要合并分支时，一般是通过 github 网页提 pr（pull reqest） 的方式来完成。

分支的命名一般是 `对应服务名字_dev` 的格式， dev 的意思就是 develop 开发的意思。

```
master 1-2-3--------7
           |       /
           |      /
test_dev   3-4-5-6
```

### 2. 忽略文件

有一些文件是可有可无的，比如运行产生的日志文件，和编译产生的二进制文件、交换文件等。在推仓库的时候，我们往往希望忽略这些文件。忽略文件的操作可以通过修改当前目录下的 `.gitignore` 文件实现。如果没有就新建。在项目开始时，最好先建好该文件。

.gitignore 文件可以在该项目中的任意位置。一般只有根目录有，这个时候其中写的忽略规则会递归地调用在所有文件中。当子目录中也有时，此时的规则只作用于它所在的目录。

下面时规范：（引用自[来源](https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E8%AE%B0%E5%BD%95%E6%AF%8F%E6%AC%A1%E6%9B%B4%E6%96%B0%E5%88%B0%E4%BB%93%E5%BA%93)

* 所有空行或者以 # 开头的行都会被 Git 忽略。

* 可以使用标准的 glob 模式匹配，它会递归地应用在整个工作区中。

* 匹配模式可以以（/）开头防止递归。

* 匹配模式可以以（/）结尾指定目录。

* 要忽略指定模式以外的文件或目录，可以在模式前加上叹号（!）取反。

>所谓的 glob 模式是指 shell 所使用的简化了的正则表达式。 星号（`*`）匹配零个或多个任意字符；`[abc]` 匹配任何一个列在方括号中的字符 （这个例子要么匹配一个 `a`，要么匹配一个 `b`，要么匹配一个 `c`）； 问号（`?`）只匹配一个任意字符；如果在方括号中使用短划线分隔两个字符， 表示所有在这两个字符范围内的都可以匹配（比如 `[0-9]` 表示匹配所有 `0` 到 `9` 的数字）。 使用两个星号（`**`）表示匹配任意中间目录，比如 `a/**/z` 可以匹配 `a/z` 、 `a/b/z` 或 `a/b/c/z` 等。

然后来看一下具体的 .gitignore 文件例子：

```
# 忽略所有的 .a 文件
*.a

# 但跟踪所有的 lib.a，即便你在前面忽略了 .a 文件
!lib.a

# 只忽略当前目录下的 TODO 文件，而不忽略 subdir/TODO
/TODO

# 忽略任何目录下名为 build 的文件夹
build/

# 忽略 doc/notes.txt，但不忽略 doc/server/arch.txt
doc/*.txt

# 忽略 doc/ 目录及其所有子目录下的 .pdf 文件
doc/**/*.pdf
```

### 3. 删除暂存区的记录

`git rm -f`

`-f` 意味 `force` 即强制删除以前的快照。

有一些文件因为没有设置 ,gitignore 而全部 `git add` 到了暂存区，则可以用以下命令

### ... 未完待续
